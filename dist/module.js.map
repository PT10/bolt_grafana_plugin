{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../node_modules/tslib/tslib.es6.js","webpack:///./datasource.ts","webpack:///./datasourceUtils.ts","webpack:///./module.tsx","webpack:///./queryEditor.tsx","webpack:///external \"@grafana/runtime\"","webpack:///external \"@grafana/ui\"","webpack:///external \"lodash\"","webpack:///external \"react\""],"names":[],"mappings":"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","file":"module.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./module.tsx\");\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*\n *\n *  Copyright (C) 2019 Bolt Analytics Corporation\n *\n *      Licensed under the Apache License, Version 2.0 (the \"License\");\n *      you may not use this file except in compliance with the License.\n *      You may obtain a copy of the License at\n *\n *          http://www.apache.org/licenses/LICENSE-2.0\n *\n *      Unless required by applicable law or agreed to in writing, software\n *      distributed under the License is distributed on an \"AS IS\" BASIS,\n *      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *      See the License for the specific language governing permissions and\n *      limitations under the License.\n *\n */\n\nimport { DataQueryRequest, DataSourceApi, DataSourceInstanceSettings } from '@grafana/ui';\nimport { DataFrame } from '@grafana/data';\nimport { BoltQuery, BoltOptions } from './types';\nimport { getBackendSrv } from '@grafana/runtime';\nimport { Utils } from 'datasourceUtils';\n\nimport _ from 'lodash';\n\nexport class BoltDatasource extends DataSourceApi<BoltQuery, BoltOptions> {\n  data: DataFrame[] = [];\n  baseUrl: any = '';\n  anCollection = '';\n  jobConfigCollection = '';\n  rawCollection = '';\n  rawCollectionType = 'single';\n  timestampField = 'timestamp';\n  anomalyThreshold = 5;\n  topN = 10;\n  rawCollectionWindow = 1;\n  backendSrv: any;\n  qTemp: any;\n  $q: any;\n  templateSrv: any;\n\n  jobIdMappings: { dashboards: any; panels: any };\n\n  totalCount?: number = undefined;\n\n  facets: any = {\n    aggAnomaly:\n      '{\"heatMapFacet\":{\"numBuckets\":true,\"offset\":0,\"limit\":__TOPN__,\"sort\":\"s desc\",\"type\":\"terms\",\"field\":\"jobId\",' +\n      '\"facet\":{\"s\": \"max(score_value)\", \"Day0\":{\"type\":\"range\",' +\n      '\"field\":\"timestamp\",\"start\":\"__START_TIME__\",\"end\":\"__END_TIME__\",\"gap\":\"__AGG_INTERVAL__\",\"facet\":{\"score\":{\"type\":\"query\",' +\n      '\"q\":\"score_value:[__SCORE_THRESHOLD__ TO *]\", \"facet\":{\"score\":\"max(score_value)\"}}}}}}}',\n    aggAnomalyByPartFields:\n      '{\"heatMapByPartFieldsFacet\":{\"numBuckets\":true,\"offset\":0,\"limit\": __TOPN__,\"type\":\"terms\",\"field\":\"jobId\",' +\n      '\"facet\":{\"partField\":{\"type\":\"terms\",\"field\":\"partition_fields\",\"limit\": __TOPN__,\"sort\":\"s desc\",' +\n      '\"facet\":{\"s\":\"max(score_value)\",\"Day0\":{\"type\":\"range\",\"field\":\"timestamp\",\"start\":\"__START_TIME__\",\"end\":\"__END_TIME__\",' +\n      '\"gap\":\"__AGG_INTERVAL__\",' +\n      '\"facet\":{\"score\":{\"type\":\"query\",\"q\":\"score_value:[__SCORE_THRESHOLD__ TO *]\",\"facet\":{\"score\":\"max(score_value)\"}}}}}}}}}',\n    indvAnomaly:\n      '{\"lineChartFacet\":{\"numBuckets\":true,\"offset\":0,\"limit\":__TOPN__,\"type\":\"terms\",\"field\":\"jobId\",\"facet\":{\"group\":{\"numBuckets\":true,' +\n      '\"offset\":0,\"limit\":__TOPN__,\"type\":\"terms\",\"field\":\"partition_fields\",\"sort\":\"s desc\",\"ss\":\"sum(s)\",\"facet\":{\"s\":\"max(score_value)\",' +\n      '\"timestamp\":{\"type\":\"terms\",\"limit\":-1,\"field\":\"timestamp\",\"facet\":{\"actual\":{\"type\":\"terms\",\"field\":\"actual_value\"}, ' +\n      '\"score\":{\"type\":\"terms\",\"field\":\"score_value\"},\"anomaly\":{\"type\":\"terms\",\"field\":\"is_anomaly\"},' +\n      '\"expected\":{\"type\":\"terms\",\"field\":\"expected_value\"}}}}}}}}',\n    correlation:\n      '{\"correlation\":{\"numBuckets\":true,\"offset\":0,\"limit\":__TOPN__,\"type\":\"terms\",\"field\":\"jobId\",\"facet\":{\"group\":{\"numBuckets\":true,' +\n      '\"offset\":0,\"limit\":__TOPN__,\"type\":\"terms\",\"field\":\"partition_fields\",\"sort\":\"s desc\",\"ss\":\"sum(s)\",\"facet\":{\"s\":\"sum(score_value)\",' +\n      '\"timestamp\":{\"type\":\"terms\",\"limit\":-1,\"field\":\"timestamp\",\"sort\":\"index\",\"facet\":{\"actual\":{\"type\":\"terms\",\"field\":\"actual_value\"}}}}}}}}',\n  };\n\n  constructor(instanceSettings: DataSourceInstanceSettings<BoltOptions>, $q: any, templateSrv: any) {\n    super(instanceSettings);\n\n    this.jobIdMappings = { dashboards: {}, panels: {} };\n    this.$q = $q;\n    this.templateSrv = templateSrv;\n\n    this.baseUrl = instanceSettings.url;\n    if (this.baseUrl.endsWith('/')) {\n      this.baseUrl += 'solr';\n    } else {\n      this.baseUrl += '/solr';\n    }\n\n    if (instanceSettings.jsonData) {\n      this.anCollection = instanceSettings.jsonData.anCollection;\n      this.jobConfigCollection = instanceSettings.jsonData.jobConfigCollection;\n      this.rawCollection = instanceSettings.jsonData.rawCollection;\n      this.timestampField = instanceSettings.jsonData.timestampField;\n      this.rawCollectionType = instanceSettings.jsonData.rawCollectionType;\n      this.rawCollectionWindow = instanceSettings.jsonData.rawCollectionWindow;\n\n      if (instanceSettings.jsonData.anomalyThreshold) {\n        this.anomalyThreshold = instanceSettings.jsonData.anomalyThreshold;\n      }\n\n      if (instanceSettings.jsonData.topN) {\n        this.topN = parseInt(instanceSettings.jsonData.topN, 10);\n      }\n    }\n\n    this.backendSrv = getBackendSrv();\n\n    this.buildValuesMap();\n  }\n\n  metricFindQuery(query: string) {\n    if (!query || query.length === 0) {\n      return Promise.resolve([]);\n    }\n\n    const pattern1 = /^getPageCount\\(\\$(.*),\\s*\\$(.*)\\)$/;\n    const pattern2 = /^(.*)\\((.*):\\s*(.*),\\s*(.*)\\)$/;\n\n    const matches1: any = query.match(pattern1);\n    const matches2: any = query.match(pattern2);\n\n    if (matches1 && matches1.length === 3) {\n      return this.getTotalCount(matches1);\n    } else if (matches2 && matches2.length === 5) {\n      return this.getFields(matches2);\n    } else {\n      return Promise.reject({\n        status: 'error',\n        message: 'Supported options are: <collection_name>(<filter>,<field_name>) and getPageCount($PageSize, $Search)',\n        title: 'Error while adding the variable',\n      });\n    }\n  }\n\n  query(options: DataQueryRequest<BoltQuery>): any {\n    const targetPromises = options.targets\n      .map((query: BoltQuery) => {\n        // If user has added page number variable the count is computed in template init (metricFindQuery) No need to fire the Query on solr again\n        if (query.queryType === 'count' && this.totalCount) {\n          return Promise.resolve([\n            {\n              data: [\n                {\n                  target: 'Number of docs',\n                  datapoints: [[this.totalCount, '']],\n                },\n              ],\n            },\n          ]);\n        }\n\n        const collection = _.keys(this.facets).includes(query.queryType) ? this.anCollection : query.collection;\n        if (!query.query) {\n          return Promise.resolve([]);\n        }\n\n        let q = this.getQueryString(query, options);\n\n        // Provision for empty series filter\n        if (q.match(/AND\\s*$/)) {\n          q = q.slice(0, q.lastIndexOf('AND'));\n        }\n\n        let start = this.templateSrv.replace(query.start, options.scopedVars);\n        let numRows = this.templateSrv.replace(query.numRows.toString(), options.scopedVars) || 100;\n        if (query.queryType === 'chart') {\n          numRows = 1000; // Cursor page size\n        } else {\n          numRows = ['count', 'facet'].includes(query.queryType) ? 0 : numRows;\n        }\n        numRows = Number(numRows);\n        start = numRows * Number(start);\n\n        const startTime = options.range.from.toISOString();\n        const endTime = options.range.to.toISOString();\n\n        const solrQueryBody: any = {};\n        solrQueryBody.query = q;\n\n        // Add basic query fields\n        const solrQueryParams: any = {\n          fq: this.timestampField + ':[' + startTime + ' TO ' + endTime + ']',\n          fl: this.timestampField + (query.fl ? ',' + query.fl : ''),\n          rows: numRows,\n          start: start,\n        };\n\n        // Add fields specific to raw logs and single stat on raw logs\n        if (query.queryType === 'rawlogs' || query.queryType === 'count' || query.queryType === 'slowQueries') {\n          solrQueryParams['collectionWindow'] = this.rawCollectionWindow;\n          solrQueryParams['startTime'] = startTime;\n          solrQueryParams['endTime'] = endTime;\n          solrQueryParams['getRawMessages'] = true;\n        }\n\n        if (query.queryType === 'slowQueries') {\n          solrQueryParams['rex.message.q'] = query.rexQuery;\n          solrQueryParams['rex.message.outputfields'] = query.rexOutFields;\n        }\n\n        // Set facet fields for heatmap, linechart and count (only in case of multi collection mode due to plugin numFound limitation)\n        // TODO: Find out why numFound is returned only after specifying the facet\n        if (query.queryType === 'count' && this.rawCollectionType === 'multi') {\n          solrQueryParams['facet'] = true;\n          solrQueryParams['facet.field'] = 'id';\n          solrQueryParams['facet.limit'] = 2;\n        } else if (_.keys(this.facets).includes(query.queryType)) {\n          const aggInterval = this.templateSrv.replace(query.aggInterval, options.scopedVars) || '+1HOUR';\n          solrQueryParams['facet'] = true;\n          solrQueryParams['json.facet'] = this.facets[query.queryType]\n            .replace('__AGG_INTERVAL__', aggInterval)\n            .replace('__START_TIME__', startTime)\n            .replace('__END_TIME__', endTime)\n            .replace(/__TOPN__/g, this.topN)\n            .replace('__SCORE_THRESHOLD__', this.anomalyThreshold);\n        } else {\n          delete solrQueryParams['facet'];\n          delete solrQueryParams['json.facet'];\n        }\n\n        // for cursor to work. Will sort by ts later\n        if (query.queryType === 'chart') {\n          solrQueryParams['sort'] = 'id asc';\n        } else if (query.sortField) {\n          solrQueryParams['sort'] =\n            this.templateSrv.replace(query.sortField, options.scopedVars) + ' ' + this.templateSrv.replace(query.sortOrder, options.scopedVars);\n        }\n\n        const httpOpts = {\n          url: this.baseUrl + '/' + collection + '/select?wt=json',\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json;charset=utf-8' },\n          params: solrQueryParams,\n          data: solrQueryBody, // There can be a big query due to long jobIds and hence it is sent in post request body\n        };\n\n        const cursor = query.queryType === 'chart' ? '*' : null;\n\n        return this.sendQueryRequest([], httpOpts, query, cursor); // cursor mark or charts\n      })\n      .values();\n\n    const series: any = {};\n    const resultSeries: any[] = [];\n\n    return Promise.all(targetPromises).then(responses => {\n      responses.forEach(resp => {\n        resp.forEach((r: any) => {\n          r.data.forEach((s: any) => {\n            if (s.type === 'table') {\n              resultSeries.push(s);\n            } else {\n              series[s.target] = !series[s.target] ? s.datapoints : series[s.target].concat(s.datapoints);\n            }\n          });\n        });\n      });\n\n      _.keys(series).forEach(key => {\n        resultSeries.push({\n          target: key,\n          datapoints: series[key].sort((a: any, b: any) => {\n            return a[1] - b[1];\n          }),\n        });\n      });\n\n      const result = {\n        data: resultSeries,\n      };\n\n      return result;\n    });\n  }\n\n  testDatasource() {\n    const options = {\n      url: this.baseUrl + '/' + this.anCollection + '/select?wt=json',\n      method: 'GET',\n    };\n    return this.backendSrv\n      .datasourceRequest(options)\n      .then((response: any) => {\n        if (response.status === 200) {\n          return {\n            status: 'success',\n            message: 'Data source is working',\n            title: 'Success',\n          };\n        } else {\n          return {\n            status: 'error',\n            message: 'Data source is NOT working',\n            title: 'Error',\n          };\n        }\n      })\n      .catch((error: any) => {\n        return {\n          status: 'error',\n          message: error.status + ': ' + error.statusText,\n          title: 'Error',\n        };\n      });\n  }\n\n  sendQueryRequest(respArr: any[], options: any, query: BoltQuery, cursor?: any) {\n    /*params.method = 'POST';\n    params.headers = { 'Content-Type': 'application/json' };*/\n\n    if (cursor) {\n      options.params['cursorMark'] = cursor;\n    }\n    return this.backendSrv\n      .datasourceRequest(options)\n      .then((response: any) => {\n        if (response.status === 200) {\n          const groupMap = this.jobIdMappings;\n\n          const processedData = Utils.processResponse(\n            response,\n            query.queryType,\n            this.timestampField,\n            this.anomalyThreshold,\n            query.baseMetric,\n            groupMap,\n            JSON.parse(query.groupEnabled),\n            query.indvAnOutField,\n            this.topN\n          );\n\n          respArr.push(processedData);\n\n          if (cursor && response.data.nextCursorMark && cursor !== response.data.nextCursorMark) {\n            return this.sendQueryRequest(respArr, options, query, response.data.nextCursorMark);\n          } else {\n            return respArr;\n          }\n        } else {\n          return Promise.reject([\n            {\n              status: 'error',\n              message: 'Error',\n              title: 'Error',\n            },\n          ]);\n        }\n      })\n      .catch((error: any) => {\n        return Promise.reject([\n          {\n            status: 'error',\n            message: error.status + ': ' + error.statusText,\n            title: 'Error while accessing data',\n          },\n        ]);\n      });\n  }\n\n  getFields(matches: any) {\n    const collection = matches[1];\n    const filterField = matches[2];\n    let filterFieldVal = matches[3].replace('$', '');\n    const field = matches[4];\n\n    const variable = this.templateSrv.variables.find((v: any) => v.name === filterFieldVal);\n    if (variable) {\n      let dashboards: string[] = [];\n      if (typeof variable.current.value !== 'object') {\n        dashboards.push(variable.current.value);\n      } else {\n        dashboards = variable.current.value;\n      }\n\n      if (dashboards[0] === '$__all') {\n        if (!variable || !variable.options || variable.options.length < 2) {\n          filterFieldVal = '';\n        } else {\n          const allPanles = variable.options\n            .slice(1)\n            .map((opt: any) => {\n              return '\"' + opt.text + '\"';\n            })\n            .join(' OR ');\n          filterFieldVal = '(' + allPanles + ')';\n        }\n      } else {\n        dashboards = dashboards.map(dashboard => {\n          return '\"' + dashboard + '\"';\n        });\n        filterFieldVal = '(' + dashboards.join(' OR ') + ')';\n      }\n    }\n\n    const url = this.baseUrl + '/' + collection + '/select?facet=true&facet.field=' + field + '&wt=json&rows=0&facet.limit=-1';\n    const params = {\n      url: url,\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      data: { query: filterField + ': ' + filterFieldVal },\n    };\n    return this.backendSrv.datasourceRequest(params).then((response: any) => {\n      if (response.status === 200) {\n        return Utils.mapToTextValue(response);\n      } else {\n        return Promise.reject([\n          {\n            status: 'error',\n            message: 'Error',\n            title: 'Error',\n          },\n        ]);\n      }\n    });\n  }\n\n  buildValuesMap() {\n    const url = this.baseUrl + '/' + this.jobConfigCollection + '/select?q=jobId:*&fl=jobId,name,searchGroup&rows=10000';\n    const params = {\n      url: url,\n      method: 'GET',\n    };\n    return this.backendSrv.datasourceRequest(params).then((response: any) => {\n      if (response.status === 200) {\n        this.jobIdMappings = { dashboards: {}, panels: {} };\n        response.data.response.docs.forEach((doc: any) => {\n          this.jobIdMappings.dashboards[doc.jobId] = doc.searchGroup[0];\n          this.jobIdMappings.panels[doc.jobId] = doc.name;\n        });\n      }\n    });\n  }\n\n  getTotalCount(matches: any) {\n    const pageSizeVar = matches[1];\n    const searchVar = matches[2];\n\n    const searchQuery = this.templateSrv.variables.find((v: any) => v.name === searchVar);\n    if (!searchQuery) {\n      this.totalCount = undefined;\n      return Promise.reject({\n        status: 'error',\n        message: '$' + searchVar + ' not found in variables',\n        title: 'Error while adding the variable',\n      });\n    }\n\n    const pageSize = this.templateSrv.variables.find((v: any) => v.name === pageSizeVar);\n    if (!pageSize) {\n      this.totalCount = undefined;\n      return Promise.reject({\n        status: 'error',\n        message: '$' + pageSizeVar + ' not found in variables',\n        title: 'Error while adding the variable',\n      });\n    }\n\n    const params = {\n      q: searchQuery.query,\n      rows: 0,\n      fq: 'timestamp:[' + this.templateSrv.timeRange.from.toJSON() + ' TO ' + this.templateSrv.timeRange.to.toJSON() + ']',\n      getRawMessages: true,\n      startTime: this.templateSrv.timeRange.from.toJSON(),\n      endTime: this.templateSrv.timeRange.to.toJSON(),\n      facet: true,\n      'facet.field': 'id',\n      'facet.limit': 2,\n    };\n\n    const options = {\n      url: this.baseUrl + '/' + this.rawCollection + '/select?wt=josn',\n      method: 'GET',\n      params: params,\n    };\n\n    return this.backendSrv.datasourceRequest(options).then((data: any) => {\n      this.totalCount = data.data.response.numFound;\n      return Utils.getFirstAndLastNResults(data, pageSize);\n    });\n  }\n\n  getQueryString(query: BoltQuery, options: DataQueryRequest<BoltQuery>) {\n    let q: string;\n    const queryStr = this.templateSrv.replace(query.query, options.scopedVars);\n    const matches = queryStr.match(/__dashboard__:\\s*(.*)/);\n    let matches2 = queryStr.match(/__panel__:\\s*(.*) AND .*/);\n    if (!matches2) {\n      matches2 = queryStr.match(/__panel__:\\s*(.*)/);\n    }\n\n    if (matches && matches.length === 2) {\n      // Dashboard case\n      const dahsboardName: string = matches[1];\n      if (dahsboardName === '*') {\n        q = queryStr.replace('__dashboard__', 'jobId');\n      } else if (dahsboardName.startsWith('{')) {\n        // All option\n        const jobIdList: any[] = [];\n        const dashboards = dahsboardName\n          .replace('{', '')\n          .replace('}', '')\n          .split(',');\n\n        dashboards.forEach(dashboard => {\n          const jobId: string[] = Object.keys(this.jobIdMappings.dashboards).filter(jobId => {\n            return this.jobIdMappings.dashboards[jobId] === dashboard;\n          });\n\n          if (jobId) {\n            jobId.forEach(job => jobIdList.push(job));\n          }\n        });\n\n        const jobIdStr = '(' + jobIdList.join(' OR ') + ')';\n        q = queryStr.replace('__dashboard__', 'jobId').replace(dahsboardName, jobIdStr);\n      } else {\n        // particular option\n        const jobIdList: string[] = Object.keys(this.jobIdMappings.dashboards).filter((jobId: string) => {\n          return this.jobIdMappings.dashboards[jobId] === dahsboardName;\n        });\n\n        const jobIdStr = '( ' + jobIdList.join(' OR ') + ' )';\n        q = queryStr.replace('__dashboard__', 'jobId').replace(dahsboardName, jobIdStr);\n      }\n      q = Utils.queryBuilder(q);\n    } else if (matches2 && matches2.length === 2) {\n      // Panel case\n      const panelName: string = matches2[1];\n\n      if (panelName === '*') {\n        q = queryStr.replace('__panel__', 'jobId');\n      } else if (panelName.startsWith('{')) {\n        // All option\n        const jobIdList: any[] = [];\n        const panels = panelName\n          .replace('{', '')\n          .replace('}', '')\n          .split(',');\n\n        panels.forEach(panel => {\n          const jobId = Object.keys(this.jobIdMappings.panels).filter(jobId => {\n            return this.jobIdMappings.panels[jobId] === panel;\n          });\n\n          if (jobId) {\n            jobIdList.push(jobId);\n          }\n        });\n\n        const jobIdStr = '(' + jobIdList.join(' OR ') + ')';\n        q = queryStr.replace('__panel__', 'jobId').replace(panelName, jobIdStr);\n      } else {\n        // particular option\n        const jobIdList: string[] = Object.keys(this.jobIdMappings.panels).filter((jobId: string) => {\n          return this.jobIdMappings.panels[jobId] === panelName;\n        });\n\n        const jobIdStr = '( ' + jobIdList.join(' OR ') + ' )';\n        q = queryStr.replace('__panel__', 'jobId').replace(panelName, jobIdStr);\n      }\n      q = Utils.queryBuilder(q);\n    } else {\n      q = Utils.queryBuilder(queryStr);\n    }\n\n    return q;\n  }\n}\n\nexport default BoltDatasource;\n","/*\n *\n *  Copyright (C) 2019 Bolt Analytics Corporation\n *\n *      Licensed under the Apache License, Version 2.0 (the \"License\");\n *      you may not use this file except in compliance with the License.\n *      You may obtain a copy of the License at\n *\n *          http://www.apache.org/licenses/LICENSE-2.0\n *\n *      Unless required by applicable law or agreed to in writing, software\n *      distributed under the License is distributed on an \"AS IS\" BASIS,\n *      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *      See the License for the specific language governing permissions and\n *      limitations under the License.\n *\n */\n\nexport class Utils {\n  static processResponse(\n    response: any,\n    format: any,\n    timeField: string,\n    anomalyThreshold: number,\n    correlationMetric: string,\n    groupMap: any,\n    grouppingEmabled: boolean,\n    indvAnOutField: string,\n    topN: number\n  ) {\n    const data = response.data;\n    let seriesList: any;\n    const series: any = {};\n\n    // Process line chart facet response\n    if (data.facets && data.facets.lineChartFacet) {\n      seriesList = [];\n      let sortBaselineSeries: any[] = [];\n      const jobs = data.facets.lineChartFacet.buckets;\n      jobs.forEach((job: any) => {\n        const partFields = job.group.buckets;\n        partFields.forEach((partField: any) => {\n          const dashboardName = groupMap.dashboards[job.val] ? groupMap.dashboards[job.val] + '_' : '';\n          const panelName = groupMap.panels[job.val] ? groupMap.panels[job.val] : '';\n          let jobIdWithPartField: string = dashboardName + panelName;\n          const partFieldJson = JSON.parse(partField.val);\n          Object.keys(partFieldJson).forEach(key => {\n            if (key === 'aggr_field') {\n              return;\n            }\n            jobIdWithPartField += '_' + key + '_' + partFieldJson[key];\n          });\n          jobIdWithPartField += '_' + partFieldJson.aggr_field;\n\n          if (jobIdWithPartField.startsWith('_')) {\n            jobIdWithPartField = jobIdWithPartField.slice(1);\n          }\n\n          const buckets = partField.timestamp.buckets;\n          const actualSeries: any[] = [];\n          const scoreSeries: any[] = [];\n          const anomalySeries: any[] = [];\n          const expectedSeries: any[] = [];\n          buckets.forEach((timeBucket: any) => {\n            const d: Date = new Date(timeBucket.val);\n            const ts = d.getTime();\n            const actual = timeBucket.actual.buckets[0].val;\n            let score = timeBucket.score.buckets[0].val;\n            let anomaly = timeBucket.anomaly.buckets[0].val;\n            const expected = timeBucket.expected.buckets[0].val;\n            if (score >= anomalyThreshold && anomaly) {\n              anomaly = actual;\n            } else {\n              anomaly = null;\n              score = null;\n            }\n            actualSeries.push([actual, ts]);\n            scoreSeries.push([score, ts]);\n            anomalySeries.push([anomaly, ts]);\n            expectedSeries.push([expected, ts]);\n          });\n\n          seriesList.push({\n            target: jobIdWithPartField + ' actual',\n            datapoints: actualSeries,\n          });\n          seriesList.push({\n            target: jobIdWithPartField + ' score',\n            datapoints: scoreSeries,\n          });\n          //Sort baseline is score value.\n          sortBaselineSeries.push({\n            target: jobIdWithPartField,\n            datapoints: scoreSeries,\n          });\n          seriesList.push({\n            target: jobIdWithPartField + ' anomaly',\n            datapoints: anomalySeries,\n          });\n          seriesList.push({\n            target: jobIdWithPartField + ' expected',\n            datapoints: expectedSeries,\n          });\n        });\n      });\n      sortBaselineSeries = this.sortList(sortBaselineSeries, topN);\n      seriesList = this.getSortedSeries(seriesList, sortBaselineSeries, indvAnOutField);\n    } else if (data.facets && data.facets.correlation) {\n      seriesList = [];\n      const jobs = data.facets.correlation.buckets;\n\n      let baseline: number[] = [];\n      // Find baseline series and populate base metric\n      jobs.forEach((job: any) => {\n        if (job.val === correlationMetric) {\n          const partFields = job.group.buckets;\n          partFields.forEach((partField: any) => {\n            const partFieldJson = JSON.parse(partField.val);\n            const jobIdWithPartField = partFieldJson.aggr_field;\n            const buckets = partField.timestamp.buckets;\n            const actualSeries: any[] = [];\n            buckets.forEach((timeBucket: any) => {\n              const d: Date = new Date(timeBucket.val);\n              const ts = d.getTime();\n              const actual = timeBucket.actual.buckets[0].val;\n\n              actualSeries.push([actual, ts]);\n              baseline.push(actual);\n            });\n\n            seriesList.push({\n              target: jobIdWithPartField,\n              datapoints: actualSeries,\n            });\n          });\n        }\n      });\n\n      baseline = Utils.getStdDev(baseline);\n\n      // Populate other metrics and find deviation from baseline\n      jobs.forEach((job: any) => {\n        if (job.val !== correlationMetric) {\n          const partFields = job.group.buckets;\n          partFields.forEach((partField: any) => {\n            const partFieldJson = JSON.parse(partField.val);\n            const jobIdWithPartField = partFieldJson.aggr_field;\n            const buckets = partField.timestamp.buckets;\n            const actualSeries: any[] = [];\n\n            let compare: any[] = [];\n            buckets.forEach((timeBucket: any) => {\n              const d: Date = new Date(timeBucket.val);\n              const ts = d.getTime();\n              const actual = timeBucket.actual.buckets[0].val;\n              compare.push(actual);\n              actualSeries.push([actual, ts]);\n            });\n\n            compare = Utils.getStdDev(compare);\n            const dev = this.findCorrelation(baseline, compare);\n\n            seriesList.push({\n              target: jobIdWithPartField + ': ' + dev.toFixed(3),\n              datapoints: actualSeries,\n            });\n          });\n        }\n      });\n    } else if (data.facets && data.facets.heatMapByPartFieldsFacet) {\n      // Heatmap\n      seriesList = [];\n      const jobs = data.facets.heatMapByPartFieldsFacet.buckets;\n      jobs.forEach((job: any) => {\n        const partBuckets = job.partField.buckets;\n        partBuckets.forEach((partField: any) => {\n          const score: number = partField.s;\n          const dayBuckets = partField.Day0.buckets;\n          const seriesData: any[] = [];\n          dayBuckets.forEach((bucket: any) => {\n            const d: Date = new Date(bucket.val);\n            if (bucket.score != null && bucket.score.score != null) {\n              seriesData.push([bucket.score.score, d.getTime()]);\n            } else {\n              seriesData.push([0, d.getTime()]);\n            }\n          });\n          // Derive series name from part fields\n          const partFieldJson = JSON.parse(partField.val);\n          const dashboardName = groupMap.dashboards[job.val] ? groupMap.dashboards[job.val] + '_' : '';\n          const panelName = groupMap.panels[job.val] ? groupMap.panels[job.val] : '';\n          let seriesName = dashboardName + panelName;\n          Object.keys(partFieldJson).forEach(key => {\n            if (key === 'aggr_field') {\n              return;\n            }\n            seriesName += '_' + key + '_' + partFieldJson[key];\n          });\n          seriesName += '_' + partFieldJson.aggr_field;\n\n          if (seriesName.startsWith('_')) {\n            seriesName = seriesName.slice(1);\n          }\n\n          seriesList.push({\n            target: seriesName,\n            datapoints: seriesData,\n            score: score,\n          });\n        });\n      });\n\n      seriesList = this.sortList(seriesList, topN).reverse(); // reverse because heatmap starts from bottom\n    } else if (data.facets && data.facets.heatMapFacet) {\n      // Heatmap\n      seriesList = [];\n      const jobs = data.facets.heatMapFacet.buckets;\n      jobs.forEach((job: any) => {\n        const dayBuckets = job.Day0.buckets;\n        const seriesData: any[] = [];\n        dayBuckets.forEach((bucket: any) => {\n          const d: Date = new Date(bucket.val);\n          if (bucket.score != null && bucket.score.score != null) {\n            seriesData.push([bucket.score.score, d.getTime()]);\n          } else {\n            seriesData.push([0, d.getTime()]);\n          }\n        });\n\n        const dashboardName = groupMap.dashboards[job.val] ? groupMap.dashboards[job.val] + '_' : '';\n        const panelName = groupMap.panels[job.val] ? groupMap.panels[job.val] : '';\n        const targetName = dashboardName + panelName;\n        seriesList.push({\n          jobId: job.val,\n          target: targetName !== '' ? targetName : job.val,\n          datapoints: seriesData,\n        });\n      });\n\n      if (grouppingEmabled) {\n        seriesList = Utils.getGrouppedResults(seriesList, groupMap);\n      }\n\n      seriesList = this.sortList(seriesList).reverse(); // reverse because heatmap starts from bottom\n    } else if (format === 'rawlogs' || format === 'slowQueries') {\n      // Table\n      const columns: any[] = [];\n      const rows: any[] = [];\n      seriesList = {};\n      let index = 0;\n      if (data && data.response && data.response.docs) {\n        data.response.docs.forEach((item: any) => {\n          const row = [];\n          for (const property in item) {\n            // Set columns\n            if (index === 0 && item.hasOwnProperty(property)) {\n              if (property === timeField) {\n                columns.unshift({ type: 'time', text: 'Time' });\n              } else {\n                columns.push({ type: 'string', text: property });\n              }\n            }\n            // Set rows\n            if (property === timeField) {\n              const d: Date = new Date(item[timeField]);\n\n              const ts = d.getTime(); //.unix() * 1000;\n              row.unshift(ts);\n            } else {\n              row.push(item[property]);\n            }\n          }\n          index++;\n          rows.push(row);\n        });\n      }\n      seriesList = [\n        {\n          type: 'table',\n          columns: columns,\n          rows: rows,\n        },\n      ];\n    } else if (format === 'count') {\n      seriesList = [];\n      const numResults = data && data.response && data.response.numFound ? data.response.numFound : 0;\n      seriesList.push({\n        target: 'Number of docs',\n        datapoints: [[numResults, '']],\n      });\n    } else if (format === 'chart') {\n      // Charts\n      seriesList = [];\n      data.response.docs.forEach((item: any) => {\n        for (const property in item) {\n          if (item.hasOwnProperty(property) && property !== timeField) {\n            if (typeof series[property] === 'undefined') {\n              series[property] = [];\n            }\n            const date = new Date(item[timeField]);\n            const ts = date.getTime();\n            series[property].push([item[property] || 0, ts]);\n          }\n        }\n      });\n      for (const property in series) {\n        seriesList.push({\n          target: property,\n          datapoints: series[property].sort((a: any, b: any) => {\n            return a[1] - b[1];\n          }),\n        });\n      }\n    }\n\n    if (!seriesList) {\n      seriesList = [];\n    }\n    return {\n      data: seriesList,\n    };\n  }\n\n  static getGrouppedResults(seriesList: [], groupMap: any) {\n    const groupSeriesList: any = {};\n    const seriesListOutput: any[] = [];\n\n    seriesList.forEach((series: any) => {\n      const jobId = series.jobId;\n      const datapoints: [] = series.datapoints;\n      let dashboardName: string = groupMap.dashboards[jobId];\n\n      if (!dashboardName) {\n        dashboardName = jobId;\n      }\n      if (!groupSeriesList[dashboardName]) {\n        groupSeriesList[dashboardName] = [];\n      }\n\n      datapoints.forEach((data, index) => {\n        if (!groupSeriesList[dashboardName][index] || groupSeriesList[dashboardName][index][0] < data[0]) {\n          groupSeriesList[dashboardName][index] = data;\n        }\n      });\n    });\n\n    Object.keys(groupSeriesList).forEach((dashboard: string) => {\n      seriesListOutput.push({\n        target: dashboard,\n        datapoints: groupSeriesList[dashboard],\n      });\n    });\n\n    return seriesListOutput;\n  }\n\n  static mapToTextValue(result: any) {\n    if (result.data && result.data.collections) {\n      return result.data.collections.map((collection: string) => {\n        return {\n          text: collection,\n          value: collection,\n        };\n      });\n    }\n    if (result.data && result.data.facet_counts) {\n      const ar: any[] = [];\n      for (const key in result.data.facet_counts.facet_fields) {\n        if (result.data.facet_counts.facet_fields.hasOwnProperty(key)) {\n          const array = result.data.facet_counts.facet_fields[key];\n          for (let i = 0; i < array.length; i += 2) {\n            // take every second element\n            if (\n              array[i + 1] > 0 &&\n              !ar.find(ele => {\n                return ele.text === array[i];\n              })\n            ) {\n              let text = array[i];\n              const detectorPatternMatches = text.match(/\\( Function: .* Field: (.*) \\)/);\n              if (detectorPatternMatches) {\n                text = '\"' + detectorPatternMatches[1] + '\"';\n              }\n              ar.push({\n                text: text,\n                expandable: false,\n              });\n            }\n          }\n        }\n      }\n      return ar;\n    }\n    if (result.data) {\n      return result.data\n        .split('\\n')[0]\n        .split(',')\n        .map((field: string) => {\n          return {\n            text: field,\n            value: field,\n          };\n        });\n    }\n  }\n\n  static getFirstAndLastNResults(data: any, pageSize: any) {\n    let arr: any[] = [];\n    if (data && data.data && data.data.response) {\n      for (let i = 0; i < Math.round(data.data.response.numFound / Number(pageSize.query)); i++) {\n        arr.push(i);\n      }\n    }\n    arr = arr.map(ele => {\n      return {\n        text: ele + 1,\n        value: ele,\n      };\n    });\n    const firstNResults = arr.slice(0, 10);\n    const lastNResults = arr.splice(arr.length - 11, arr.length - 1);\n\n    if (firstNResults.length === 0 && lastNResults.length === 0) {\n      return [\n        {\n          text: 0,\n          value: 0,\n        },\n      ];\n    }\n\n    return firstNResults.concat(lastNResults);\n  }\n\n  static sortList(seriesList: any[], top?: number) {\n    seriesList.sort((a: any, b: any) => {\n      let totalA = 0;\n      let totalB = 0;\n      if (a.datapoints && b.datapoints) {\n        a.datapoints.map((d: any) => {\n          totalA += d[0];\n        });\n        b.datapoints.map((d: any) => {\n          totalB += d[0];\n        });\n      } else {\n        return 0;\n      }\n\n      return totalB - totalA;\n      // return b.score - a.score;\n    });\n\n    if (top) {\n      seriesList = seriesList.slice(0, top);\n    }\n\n    return seriesList;\n  }\n\n  static getSortedSeries(seriesToSort: any[], baselineSeries: any[], indvAnOutField: string): any[] {\n    const resultSeries: any[] = [];\n    const seriesSuffixes = indvAnOutField === 'all' ? [' actual', ' expected', ' score', ' anomaly'] : [' ' + indvAnOutField];\n    baselineSeries.forEach(baselineSer => {\n      const seriesName = baselineSer.target;\n      seriesSuffixes.forEach(suffix => {\n        resultSeries.push(\n          seriesToSort.find(s => {\n            return s.target === seriesName + suffix;\n          })\n        );\n      });\n    });\n\n    return resultSeries;\n  }\n\n  static getStdDev(series: number[]) {\n    const min = Math.min(...series);\n    const max = Math.max(...series);\n\n    series = series.map(b => {\n      return (b - min) / (max - min);\n    });\n\n    return series;\n  }\n\n  static findCorrelation(x: any, y: any) {\n    let sumX = 0,\n      sumY = 0,\n      sumXY = 0,\n      sumX2 = 0,\n      sumY2 = 0;\n    const minLength = (x.length = y.length = Math.min(x.length, y.length)),\n      reduce = (xi: any, idx: any) => {\n        const yi = y[idx];\n        sumX += xi;\n        sumY += yi;\n        sumXY += xi * yi;\n        sumX2 += xi * xi;\n        sumY2 += yi * yi;\n      };\n    x.forEach(reduce);\n    return (minLength * sumXY - sumX * sumY) / Math.sqrt((minLength * sumX2 - sumX * sumX) * (minLength * sumY2 - sumY * sumY));\n  }\n\n  static queryBuilder(query: string) {\n    return query\n      .replace(/{/g, '(')\n      .replace(/}/g, ')')\n      .replace(/,/g, ' OR ');\n  }\n}\n","/*\n *\n *  Copyright (C) 2019 Bolt Analytics Corporation\n *\n *      Licensed under the Apache License, Version 2.0 (the \"License\");\n *      you may not use this file except in compliance with the License.\n *      You may obtain a copy of the License at\n *\n *          http://www.apache.org/licenses/LICENSE-2.0\n *\n *      Unless required by applicable law or agreed to in writing, software\n *      distributed under the License is distributed on an \"AS IS\" BASIS,\n *      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *      See the License for the specific language governing permissions and\n *      limitations under the License.\n *\n */\n\nimport { DataSourcePlugin } from '@grafana/ui';\n\nimport { BoltDatasource } from './datasource';\n\nimport { BoltQueryEditor } from './queryEditor';\nimport { BoltOptions, BoltQuery } from './types';\n\nexport class BoltConfigControl {\n  static templateUrl = 'partials/config.html';\n}\n\nexport const plugin = new DataSourcePlugin<BoltDatasource, BoltQuery, BoltOptions>(BoltDatasource)\n  .setConfigCtrl(BoltConfigControl)\n  .setQueryEditor(BoltQueryEditor);\n","/*\n *\n *  Copyright (C) 2019 Bolt Analytics Corporation\n *\n *      Licensed under the Apache License, Version 2.0 (the \"License\");\n *      you may not use this file except in compliance with the License.\n *      You may obtain a copy of the License at\n *\n *          http://www.apache.org/licenses/LICENSE-2.0\n *\n *      Unless required by applicable law or agreed to in writing, software\n *      distributed under the License is distributed on an \"AS IS\" BASIS,\n *      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *      See the License for the specific language governing permissions and\n *      limitations under the License.\n *\n */\n\nimport React, { PureComponent } from 'react';\n\n// Types\nimport { BoltDatasource } from './datasource';\nimport { BoltQuery, BoltOptions } from './types';\n\nimport { FormField, QueryEditorProps, FormLabel } from '@grafana/ui';\n\nimport _ from 'lodash';\n\ntype Props = QueryEditorProps<BoltDatasource, BoltQuery, BoltOptions>;\n\ninterface State extends BoltQuery {}\n\nexport class BoltQueryEditor extends PureComponent<Props, State> {\n  query: BoltQuery;\n\n  constructor(props: Props) {\n    super(props);\n\n    const { query } = this.props;\n    this.query = query;\n\n    this.state = {\n      ...this.state,\n      query: query.query,\n      collection: query.collection,\n      fl: query.fl,\n      queryType: query.queryType || 'chart',\n      numRows: query.numRows || 100,\n      start: query.start || 0,\n      facetQuery: query.facetQuery,\n      sortField: query.sortField,\n      sortOrder: query.sortOrder,\n      rexQuery:\n        query.rexQuery ||\n        '\\\\s*.*\\\\s*\\\\[c\\\\:(.*)\\\\ss\\\\:(.*)\\\\sr\\\\:(.*)\\\\sx\\\\:(.*)\\\\]\\\\s*o.a.s.c.S.SlowRequest.*path=(.*)\\\\s*' +\n          'params=\\\\{(.*)\\\\}\\\\s*.*hits=(.*)\\\\s*status.*QTime=(.*)',\n      rexOutFields: query.rexOutFields || 'collection,shard,replica,core,handler,params,hits,qtime',\n      baseMetric: query.baseMetric,\n      groupEnabled: query.groupEnabled || 'false',\n      aggInterval: query.aggInterval || '+1HOUR',\n      indvAnOutField: query.indvAnOutField || 'all',\n    };\n\n    const { onChange } = this.props;\n    onChange({\n      ...this.props.query,\n      ...this.state,\n    });\n  }\n\n  onFieldValueChange = (event: any, _name?: string) => {\n    const name = _name ? _name : event.target.name;\n    const value = event.target.value;\n\n    this.setState({\n      ...this.state,\n      [name]: value,\n    });\n\n    const { onChange } = this.props;\n    onChange({\n      ...this.props.query,\n      [name]: value,\n    });\n  };\n\n  render() {\n    const chartTypes = [\n      { value: 'chart', displayName: 'Chart' },\n      { value: 'rawlogs', displayName: 'Raw Logs' },\n      { value: 'slowQueries', displayName: 'Slow Queries' },\n      { value: 'count', displayName: 'Count' },\n      {\n        displayName: 'Aggregated Anomalies',\n        value: 'aggAnomaly',\n      },\n      {\n        displayName: 'Anomalies by partition field',\n        value: 'aggAnomalyByPartFields',\n      },\n      {\n        displayName: 'Individual Anomalies',\n        value: 'indvAnomaly',\n      },\n      {\n        displayName: 'Correlation',\n        value: 'correlation',\n      },\n    ];\n    const {\n      query,\n      collection,\n      fl,\n      queryType,\n      numRows,\n      start,\n      sortField,\n      sortOrder,\n      rexQuery,\n      rexOutFields,\n      baseMetric,\n      groupEnabled,\n      aggInterval,\n      indvAnOutField,\n    } = this.state;\n    const labelWidth = 8;\n\n    return (\n      <div>\n        {/* First row starts */}\n        <div className=\"gf-form-inline\">\n          <div className=\"gf-form\">\n            <FormLabel width={labelWidth}>Type</FormLabel>\n            <select\n              value={queryType}\n              onChange={(event: any) => {\n                this.onFieldValueChange(event, 'queryType');\n                // this.resetFields();\n              }}\n            >\n              {chartTypes.sort().map(c => {\n                return <option value={c.value}>{c.displayName}</option>;\n              })}\n            </select>\n          </div>\n          <div className=\"gf-form\">\n            <FormField\n              label=\"Query\"\n              type=\"text\"\n              value={query}\n              labelWidth={labelWidth}\n              width={4}\n              name=\"query\"\n              onChange={this.onFieldValueChange}\n            ></FormField>\n          </div>\n          {/* Show group by infor for aggregated anomalies */}\n          {queryType === 'aggAnomaly' && (\n            <div className=\"gf-form\">\n              <FormLabel width={labelWidth}>Group Results</FormLabel>\n              <select\n                value={groupEnabled}\n                onChange={(event: any) => {\n                  this.onFieldValueChange(event, 'groupEnabled');\n                }}\n              >\n                <option value={'true'}>{'true'}</option>\n                <option value={'false'}>{'false'}</option>\n              </select>\n            </div>\n          )}\n          {/* Show out fields for individual anomalies (alerts requirement) */}\n          {queryType === 'indvAnomaly' && (\n            <div className=\"gf-form\">\n              <FormLabel width={labelWidth}>Out Field</FormLabel>\n              <select\n                value={indvAnOutField}\n                onChange={(event: any) => {\n                  this.onFieldValueChange(event, 'indvAnOutField');\n                }}\n              >\n                <option value={'all'}>{'All'}</option>\n                <option value={'actual'}>{'Actual'}</option>\n                <option value={'score'}>{'Score'}</option>\n                <option value={'expected'}>{'Expected'}</option>\n                <option value={'anomaly'}>{'Anomaly'}</option>\n              </select>\n            </div>\n          )}\n          {(queryType === 'aggAnomaly' || queryType === 'aggAnomalyByPartFields') && (\n            // <div className=\"gf-form\">\n            //   <FormLabel width={14}>Aggregation Level</FormLabel>\n            //   <select\n            //     value={aggInterval}\n            //     onChange={(event: any) => {\n            //       this.onFieldValueChange(event, 'aggInterval');\n            //     }}\n            //   >\n            //     <option value={'+1HOUR'}>{'Hour'}</option>\n            //     <option value={'+1MINUTE'}>{'Minute'}</option>\n            //   </select>\n            // </div>\n            <div className=\"gf-form\">\n              <FormField\n                label=\"Aggregation Interval\"\n                type=\"text\"\n                value={aggInterval}\n                labelWidth={12}\n                width={4}\n                name=\"aggInterval\"\n                onChange={this.onFieldValueChange}\n              ></FormField>\n            </div>\n          )}\n          {/* Show collection name textbox */}\n          {queryType !== 'aggAnomaly' && queryType !== 'indvAnomaly' && queryType !== 'correlation' && queryType !== 'aggAnomalyByPartFields' && (\n            <div className=\"gf-form\">\n              <FormField\n                label=\"Collection\"\n                type=\"text\"\n                value={collection}\n                labelWidth={labelWidth}\n                width={4}\n                name=\"collection\"\n                onChange={this.onFieldValueChange}\n              ></FormField>\n            </div>\n          )}\n          {/* Show base metric for correlation */}\n          {queryType === 'correlation' && (\n            <div className=\"gf-form\">\n              <FormField\n                label=\"Base Metric\"\n                type=\"text\"\n                value={baseMetric}\n                labelWidth={labelWidth}\n                width={4}\n                name=\"baseMetric\"\n                onChange={this.onFieldValueChange}\n              ></FormField>\n            </div>\n          )}\n          {/* First row ends */}\n        </div>\n        {/* Seconds row starts */}\n        {(queryType === 'chart' || queryType === 'rawlogs' || queryType === 'slowQueries') && (\n          <div className=\"gf-form-inline\">\n            {(queryType === 'rawlogs' || queryType === 'slowQueries') && (\n              <div>\n                <div className=\"gf-form\">\n                  <FormField\n                    label=\"Sort\"\n                    type=\"text\"\n                    value={sortField}\n                    labelWidth={labelWidth}\n                    width={4}\n                    name=\"sortField\"\n                    onChange={this.onFieldValueChange}\n                  ></FormField>\n                </div>\n                <div className=\"gf-form\">\n                  <FormField\n                    label=\"Order\"\n                    type=\"text\"\n                    value={sortOrder}\n                    labelWidth={labelWidth}\n                    width={4}\n                    name=\"sortOrder\"\n                    onChange={this.onFieldValueChange}\n                  ></FormField>\n                </div>\n              </div>\n            )}\n\n            <div className=\"gf-form\">\n              <FormField\n                label=\"Out Fields\"\n                type=\"text\"\n                value={fl}\n                labelWidth={labelWidth}\n                width={4}\n                name=\"fl\"\n                onChange={this.onFieldValueChange}\n              ></FormField>\n            </div>\n            {(queryType === 'rawlogs' || queryType === 'slowQueries') && (\n              <div className=\"gf-form\">\n                <FormField\n                  label=\"Number of rows\"\n                  labelWidth={10}\n                  type=\"text\"\n                  value={numRows}\n                  width={6}\n                  name=\"numRows\"\n                  onChange={this.onFieldValueChange}\n                ></FormField>\n              </div>\n            )}\n            {(queryType === 'rawlogs' || queryType === 'slowQueries') && (\n              <div className=\"gf-form\">\n                <FormField\n                  label=\"Start page\"\n                  type=\"text\"\n                  value={start}\n                  labelWidth={labelWidth}\n                  width={4}\n                  name=\"start\"\n                  onChange={this.onFieldValueChange}\n                ></FormField>\n              </div>\n            )}\n          </div>\n        )}\n        {queryType === 'slowQueries' && (\n          <div className=\"gf-form-inline\">\n            <div className=\"gf-form\">\n              <FormField\n                label=\"Rex Query\"\n                type=\"text\"\n                value={rexQuery}\n                labelWidth={labelWidth}\n                width={4}\n                name=\"rexQuery\"\n                onChange={this.onFieldValueChange}\n              ></FormField>\n            </div>\n            <div className=\"gf-form\">\n              <FormField\n                label=\"Output Fields\"\n                type=\"text\"\n                value={rexOutFields}\n                labelWidth={labelWidth}\n                width={4}\n                name=\"rexOutFields\"\n                onChange={this.onFieldValueChange}\n              ></FormField>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__grafana_runtime__;","module.exports = __WEBPACK_EXTERNAL_MODULE__grafana_ui__;","module.exports = __WEBPACK_EXTERNAL_MODULE_lodash__;","module.exports = __WEBPACK_EXTERNAL_MODULE_react__;"],"sourceRoot":""}